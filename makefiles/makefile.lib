
include $(MAKEFILEDIR)/makefile.prebuild

LOCAL_CFLAGS:=-Iinclude/$(LIBRARY)

DEBUG_STATIC_LIBRARY:=lib$(LIBRARY)-static-$(LIBRARY_VERSION_MAJOR_MINOR)$(STATIC_LIBRARY_SUFFIX)
DEBUG_SHARED_LIBRARY:=lib$(LIBRARY)-$(LIBRARY_VERSION_MAJOR_MINOR)$(SHARED_LIBRARY_SUFFIX)
RELEASE_STATIC_LIBRARY:=lib$(LIBRARY)-static-$(LIBRARY_VERSION_MAJOR_MINOR)$(STATIC_LIBRARY_SUFFIX)
RELEASE_SHARED_LIBRARY:=lib$(LIBRARY)-$(LIBRARY_VERSION_MAJOR_MINOR)$(SHARED_LIBRARY_SUFFIX)

.SECONDARY: $(LIBRARY).pc
.SECONDARY: $(INSTALLLIBDST)/$(DEBUG_SHARED_LIBRARY) $(INSTALLLIBDST)/$(DEBUG_SHARED_LIBRARY).$(LIBRARY_VERSION_MINOR) $(INSTALLLIBDST)/$(DEBUG_SHARED_LIBRARY).$(LIBRARY_VERSION_MINOR).$(LIBRARY_VERSION_RELEASE).$(LIBRARY_VERSION_BUILD)
.SECONDARY: $(INSTALLLIBDST)/$(RELEASE_SHARED_LIBRARY) $(INSTALLLIBDST)/$(RELEASE_SHARED_LIBRARY).$(LIBRARY_VERSION_MINOR) $(INSTALLLIBDST)/$(RELEASE_SHARED_LIBRARY).$(LIBRARY_VERSION_MINOR).$(LIBRARY_VERSION_RELEASE).$(LIBRARY_VERSION_BUILD)

DEBUG_OBJECTS:=$(OBJECTS:%=$(DEBUG_OBJDIR)/%)
RELEASE_OBJECTS:=$(OBJECTS:%=$(RELEASE_OBJDIR)/%)

LOCAL_DEBUG_TARGETS:=$(DEBUG_STATIC_LIBRARY) $(DEBUG_SHARED_LIBRARY)
LOCAL_RELEASE_TARGETS:=$(RELEASE_STATIC_LIBRARY) $(RELEASE_SHARED_LIBRARY)

ifdef DEBUG
INSTALLEDLIBS += $(LOCAL_DEBUG_TARGETS:%=$(INSTALLLIBDST)/%)
else
INSTALLEDLIBS += $(LOCAL_RELEASE_TARGETS:%=$(INSTALLLIBDST)/%)
endif

INSTALLEDHEADERS += $(HEADERS:%=$(INSTALLHDRDST)/$(LIBRARY)/%)

INSTALLEDPKGCONFIG += $(INSTALLPKGCONFIGDST)/$(LIBRARY_WITH_VERSION_MAJOR_MINOR).pc

LOCAL_DEBUG_TARGETS:=$(LOCAL_DEBUG_TARGETS:%=$(DEBUG_LIBDIR)/%)
LOCAL_RELEASE_TARGETS:=$(LOCAL_RELEASE_TARGETS:%=$(RELEASE_LIBDIR)/%)

DEBUG_TARGETS += $(LOCAL_DEBUG_TARGETS) $(LIBRARY).pc
RELEASE_TARGETS += $(LOCAL_RELEASE_TARGETS) $(LIBRARY).pc

include $(MAKEFILEDIR)/makefile.libbuild

CLEANFILES += $(LOCAL_DEBUG_TARGETS) $(LOCAL_RELEASE_TARGETS) $(LIBRARY).pc

UNINSTALLFILES += "$(INSTALLHDRDST)" "$(INSTALLLIBDST)/lib$(LIBRARY)"* "$(INSTALLPKGCONFIGDST)/$(LIBRARY)"* "$(INSTALLSHAREDST)"
